// Thumbnails generic classes
//

/*
  Expected use
  ============

  Without grid (inline-block)
  ---------------------------

  ### image

  a.thumb
    img.thumb__image
    .thumb-caption[.thumb-caption__m-secondary]
      .thumb-caption__line

  ### video

  .thumb
    a.thumb-inner
      .thumb__icon.icon.icon-video
      img.thumb__image
      .thumb-caption[.thumb-caption__m-secondary]
        .thumb-caption__line

  ### binary

  a.thumb
    .thumb__icon.icon.icon-binary
    .thumb__content
    .thumb-caption[.thumb-caption__m-secondary]
      .thumb-caption__line

  With grid (flexbox)
  -------------------

  TBD

*/


@import "nodeca.core/client/common/_variables"

thumbImageWidth  = '$$ N.config.users.uploads.resize.sm.max_width || N.config.users.uploads.resize.sm.width $$'px
thumbImageHeight = '$$ N.config.users.uploads.resize.sm.max_height || N.config.users.uploads.resize.sm.height $$'px

// 170x150 -> 119x105
downScaleSm = 1.428571429
// 170x150 -> 85x75
downScaleXs = 1.7

cornerRadius = 3px
cornerRadiusSm = 2px

// active item change border
selectionWidth = 3px

thumbImageWidthSm  = round(thumbImageWidth / downScaleSm)
thumbImageHeightSm = round(thumbImageHeight / downScaleSm)
thumbImageWidthXs  = round(thumbImageWidth / downScaleXs)
thumbImageHeightXs = round(thumbImageHeight / downScaleXs)

gridInterval   = 20px
gridIntervalSm = 20px //round(gridInterval / downScaleSm)
gridIntervalXs = 20px //round(gridInterval / downScaleXs)

gridIntervalTight   = 10px
gridIntervalTightSm = 10px //round(gridInterval / downScaleSm)
gridIntervalTightXs = 10px //round(gridInterval / downScaleXs)

//
// Grid to show thumbnails
//

.thumb-grid
  padding 0
  margin-left 0px - gridInterval + selectionWidth
  margin-right 0px - selectionWidth
  margin-top 0px - selectionWidth
  margin-bottom 0px - gridInterval + selectionWidth

.thumb-grid__item
  display inline-block
  margin-left gridInterval - (selectionWidth * 2)
  margin-bottom gridInterval - (selectionWidth * 2)
  border selectionWidth solid transparent
  border-radius 3px
  &.active
  &.selected
    border selectionWidth dotted grayDark !important
    .thumb
      opacity .5 !important

.thumb-grid__m-sm
  &.thumb-grid
    margin-left 0px - gridIntervalSm + selectionWidth
    margin-bottom 0px - gridIntervalSm + selectionWidth
  .thumb-grid__item
    margin-left gridIntervalSm - (selectionWidth * 2)
    margin-bottom gridIntervalSm - (selectionWidth * 2)


.thumb-grid__m-tight
  margin-left 0px - gridIntervalTight + selectionWidth
  margin-bottom 0px - gridIntervalTight + selectionWidth
  .thumb-grid__item
    margin-left gridIntervalTight - (selectionWidth * 2)
    margin-bottom gridIntervalTight - (selectionWidth * 2)

  &.thumb-grid__m-sm
    &.thumb-grid
      margin-left 0px - gridIntervalTightSm + selectionWidth
      margin-bottom 0px - gridIntervalTightSm + selectionWidth
    .thumb-grid__item
      margin-left gridIntervalTightSm - (selectionWidth * 2)
      margin-bottom gridIntervalTightSm - (selectionWidth * 2)

.thumb-grid__m-centered
  text-align center

.thumb-grid__m-inline
  white-space nowrap

.thumb-grid__m-shadow-tail
  position relative
  &:after
    content ""
    display block
    position absolute
    right 0
    top 0
    bottom 0
    width 20px
    background linear-gradient(to right, rgba(255,255,255,0) 0%,rgba(255,255,255,1) 100%)

//
// Thumbnail container (link)
//

.thumb
  width thumbImageWidth
  height thumbImageHeight
  display inline-block
  text-align center
  position relative
  border-radius cornerRadius
  box-shadow 0 0 2px $decorator-color

  &:before
    content ''
    height 100%
    display inline-block;
    vertical-align middle

  &:hover
    .thumb-caption
      background-color grayDark
    .thumb__control
      opacity 1

// Texts under thumbnail
.thumb-caption
  width 100%
  padding 0 3px
  display block
  position absolute
  bottom 0
  text-align left
  color grayLightest
  background-color rgba(grayDark, 0.6)
  border-radius 0 0 cornerRadius cornerRadius
  font-size 11px
  transition background-color .2s ease
  shortable()

.thumb-caption__line
  display block
  shortable()

.thumb-caption__line + .thumb-caption__line
  margin-top -0.15em

.thumb-caption.thumb-caption__m-secondary
.thumb-caption__m-secondary
  font-size 10px
  color grayLighter

// use inner only when realy need colored background
// for small images, like video previews
.thumb__inner
  display inline-block
  height 100%
  border-radius cornerRadius
  background-color #000
  vertical-align top

  &:before
    content ''
    height 100%
    display inline-block;
    vertical-align middle

.thumb__image
  max-width thumbImageWidth
  max-height thumbImageHeight
  border-radius cornerRadius
  display inline-block
  vertical-align middle
  text-align center


// Text content, when no image
.thumb__content
  display inline-block
  vertical-align middle
  max-width 100%
  padding 0 5px
  shortable()


// Icon marker
.thumb__icon
  position absolute
  font-size 25px
  top 7px
  right 7px
  color grayLighter

// For buttons
.thumb__control
  position absolute
  top 7px
  right 7px
  opacity .7
  transition opacity .2s ease

// Modifier to show images in small size
.thumb-grid__m-sm
.thumb__m-sm
  .thumb
  &.thumb
    width thumbImageWidthSm
    height thumbImageHeightSm

  .thumb__image
    max-width thumbImageWidthSm
    max-height thumbImageHeightSm

  .thumb-caption
    border-radius 0 0 cornerRadiusSm cornerRadiusSm

  .thumb
  &.thumb
  .thumb__image
  .thumb__inner
    border-radius cornerRadiusSm


//
// Responsive rules (reduce size)
//

@media (max-width: screenSm - 1)
  .thumb-grid__m-responsive
    &.thumb-grid
      padding 0
      margin-left 0px - gridIntervalSm + selectionWidth
      margin-bottom 0px - gridIntervalSm + selectionWidth

    .thumb-grid__item
      display inline-block
      margin-left gridIntervalSm - (selectionWidth * 2)
      margin-bottom gridIntervalSm - (selectionWidth * 2)
      border selectionWidth solid transparent
      border-radius 3px

    &.thumb-grid__m-tight
      margin-left 0px - gridIntervalTightSm + selectionWidth
      margin-bottom 0px - gridIntervalTightSm + selectionWidth
      .thumb-grid__item
        margin-left gridIntervalTightSm - (selectionWidth * 2)
        margin-bottom gridIntervalTightSm - (selectionWidth * 2)

  .thumb-grid__m-responsive
  .thumb__m-responsive
    .thumb
    &.thumb
      width thumbImageWidthSm
      height thumbImageHeightSm

    .thumb__image
      max-width thumbImageWidthSm
      max-height thumbImageHeightSm

    .thumb-caption
      border-radius 0 0 cornerRadiusSm cornerRadiusSm

    .thumb
    &.thumb
    .thumb__image
    .thumb__inner
      border-radius cornerRadiusSm

// For portrait mobile
@media (max-width: screenXs - 1)
  .thumb-grid__m-responsive
    &.thumb-grid
      padding 0
      margin-left 0px - gridIntervalXs + selectionWidth
      margin-bottom 0px - gridIntervalXs + selectionWidth

    .thumb-grid__item
      display inline-block
      margin-left gridIntervalXs - (selectionWidth * 2)
      margin-bottom gridIntervalXs - (selectionWidth * 2)
      border selectionWidth solid transparent
      border-radius 3px

    &.thumb-grid__m-tight
      margin-left 0px - gridIntervalTightXs + selectionWidth
      margin-bottom 0px - gridIntervalTightXs + selectionWidth
      .thumb-grid__item
        margin-left gridIntervalTightXs - (selectionWidth * 2)
        margin-bottom gridIntervalTightXs - (selectionWidth * 2)

  .thumb__m-responsive
  .thumb__m-responsive.thumb__m-sm
  .thumb-grid__m-responsive
    .thumb
    &.thumb
      width thumbImageWidthXs
      height thumbImageHeightXs

    .thumb__image
      max-width thumbImageWidthXs
      max-height thumbImageHeightXs

    .thumb-caption
      border-radius 0 0 cornerRadiusXs cornerRadiusXs

    .thumb
    &.thumb
    .thumb__image
    .thumb__inner
      border-radius cornerRadiusXs

    .thumb-caption
      font-size 10px

    .thumb-caption.thumb-caption__m-secondary
    .thumb-caption__m-secondary
      font-size 9px
